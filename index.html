<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Vortex - Player Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Všechny tvé původní styly zůstávají beze změny */
        /* ... (pro úsporu místa je zde vynechávám, přidej své původní CSS) ... */
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="player-panel">
            <div class="panel-header">
                <div class="panel-icon"><i class="fas fa-user"></i></div>
                <div class="panel-title">Player Dashboard</div>
            </div>
            
            <div class="login-box" id="login-section">
                <div class="info-title">PŘIHLÁŠENÍ</div>
                <p>Pro zobrazení svých postav a vozidel se musíš přihlásit přes Discord</p>
                <button class="login-button" id="discord-login">
                    <i class="fab fa-discord"></i>
                    Přihlásit se přes Discord
                </button>
                <div style="margin-top: 15px; font-size: 0.9rem; color: #4a8eff;">
                    <p><strong>Redirect URI:</strong> https://resilient-torte-29a707.netlify.app/callback</p>
                </div>
            </div>
            
            <div id="user-profile" style="display: none;">
                <!-- Profil uživatele a seznam postav, vozidel a inventáře -->
                <div class="user-profile">
                    <img src="" class="user-avatar" id="user-avatar" alt="User Avatar">
                    <div class="user-info">
                        <div class="user-name" id="user-name">Username</div>
                        <div class="user-discriminator" id="user-discriminator">#0000</div>
                    </div>
                    <button class="logout-btn" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
                <!-- Postavy -->
                <div class="info-box">
                    <div class="info-title">TVÉ POSTAVY</div>
                    <div class="character-list" id="character-list">
                        <div class="loading">Načítám postavy...</div>
                    </div>
                </div>
                <!-- Vozidla -->
                <div class="info-box">
                    <div class="info-title">VLASTNĚNÁ VOZIDLA</div>
                    <div class="vehicle-list" id="vehicle-list">
                        <div class="loading">Načítám vozidla...</div>
                    </div>
                </div>
                <!-- Inventář -->
                <div class="info-box">
                    <div class="info-title">INVENTÁŘ</div>
                    <div class="inventory-grid" id="inventory-grid">
                        <div class="loading">Načítám inventář...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="container">
            <div class="vortex-logo"><i class="fas fa-wind"></i> PROJECT VORTEX</div>
            <header>Project Vortex</header>
            <p style="text-align: center; color: #aaa; margin-top: 5px; font-size: 1.1rem;">
                Czech FiveM Roleplay Server
            </p>
            <div class="buttons-row">
                <a class="button discord" href="https://discord.gg/hqXuR7bHDX" target="_blank">
                    <i class="fab fa-discord"></i> Připoj se k nám na Discordu
                </a>
                <a class="button" href="pravidla.html">
                    <i class="fas fa-book"></i> PRAVIDLA
                </a>
                <a href="#" class="button" id="show-profile">
                    <i class="fas fa-user"></i> TVÉ ÚDAJE
                </a>
                <a href="fivem://connect/cfx.re/join/ellb5b" class="connect-button">
                    <i class="fas fa-play"></i> Připojit se k serveru
                </a>
            </div>
        </div>
    </div>

    <footer>
        &copy; 2023 Project Vortex. Všechna práva vyhrazena.
    </footer>

    <script>
        // KONFIGURACE
        const DISCORD_CLIENT_ID = "1419670780836319312";
        const DISCORD_REDIRECT_URI = "https://resilient-torte-29a707.netlify.app/callback";
        const DISCORD_SCOPE = "identify";

        const loginSection = document.getElementById('login-section');
        const userProfile = document.getElementById('user-profile');
        const discordLoginBtn = document.getElementById('discord-login');
        const logoutBtn = document.getElementById('logout-btn');

        function showNotification(message) { alert(message); } // jednoduchá notifikace

        // Funkce pro přihlášení
        function loginWithDiscord() {
            const url = `https://discord.com/api/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&redirect_uri=${encodeURIComponent(DISCORD_REDIRECT_URI)}&response_type=code&scope=${DISCORD_SCOPE}`;
            window.location.href = url;
        }

        discordLoginBtn.addEventListener('click', loginWithDiscord);

        // Funkce pro odhlášení
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('discordUserData');
            loginSection.style.display = 'block';
            userProfile.style.display = 'none';
            showNotification('Odhlášeno');
        });

        // Funkce pro zpracování OAuth callbacku
        function handleOAuthCallback() {
            const params = new URLSearchParams(window.location.search);
            const code = params.get('code');
            if (code) {
                // V reálném nasazení tady zavoláš backend, který vymění code za access_token a vrátí user info
                // Zde simulace
                const mockUser = {
                    id: "123456789012345678",
                    username: "ProjectVortexUser",
                    discriminator: "1234",
                    avatar: "a_abc123def456"
                };
                localStorage.setItem('discordUserData', JSON.stringify(mockUser));
                displayUserProfile(mockUser);
                // Odstranění code z URL
                window.history.replaceState({}, document.title, "/");
            }
        }

        function displayUserProfile(user) {
            loginSection.style.display = 'none';
            userProfile.style.display = 'block';
            document.getElementById('user-name').textContent = user.username;
            document.getElementById('user-discriminator').textContent = "#" + user.discriminator;
            document.getElementById('user-avatar').src = user.avatar
                ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=128`
                : `https://cdn.discordapp.com/embed/avatars/${parseInt(user.discriminator) % 5}.png`;
        }

        // Kontrola při načtení
        document.addEventListener('DOMContentLoaded', () => {
            const storedUser = localStorage.getItem('discordUserData');
            if (storedUser) {
                displayUserProfile(JSON.parse(storedUser));
            }
            handleOAuthCallback();
        });
    </script>
</body>
</html>

</body>

</html>
